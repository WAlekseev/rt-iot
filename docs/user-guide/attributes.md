---
layout: docwithnav
title: Работа с атрибутами IoT-устройств
description: Работа с атрибутами IoT-устройств

---

* TOC
{:toc}

Платформа предоставляет возможность назначать пользовательские атрибуты сущностям и управлять ими. Атрибуты описываются парами ключ-значение. 
Гибкость и простота формата ключ-значение обеспечивает легкую и бесшовную интеграцию практически с любым IoT-устройством на рынке.


## Видеоурок

<div id="video">
  <div id="video_wrapper">
    <iframe src="https://www.youtube.com/embed/JCW_hShAp7I" frameborder="0" allowfullscreen=""></iframe>
  </div>
</div>


## Типы атрибутов

Атрибуты делятся на три основные группы:

 - **server-side** - атрибутом управляет и обменивается с ним данными серверное приложение. Недоступно для приложения устройства. .
   Некоторые конфиденциальные данные, которые могут использоваться платформой, но не должны быть доступны устройству. Любая сущность платформы поддерживает server-side атрибуты: устройство, объект, клиент, тенант, правила  и т. д.
   
   {:refdef: style="text-align: center;"}
   ![image](/images/user-guide/server-side-attributes.svg)
   {: refdef}  

 - **client-side** - см. раздел специфические атрибуты устройств
 - **shared** - см. раздел специфические атрибуты устройств


## Специфические атрибуты устройств

Все атрибуты могут быть использованы в компонентах движка правил: фильтрах, процессорах и действиях.
В этом руководстве представлен обзор перечисленных выше функций и некоторые полезные ссылки для получения более подробной информации.


Специфические атрибуты устройства разделены на две основные группы:
 
 - **client-side** - атрибутом управляет и обменивается с ним данными приложение устройства. Например, текущая версия прошивки, спецификация оборудования и т. д.     

   {:refdef: style="text-align: center;"}
   ![image](/images/user-guide/client-side-attributes.svg)
   {: refdef}  
        
 - **shared** - атрибутом управляет и обменивается с ним данными серверное приложение, видимое для приложения устройства. Например, план подписки клиента, целевая версия прошивки.
   
   {:refdef: style="text-align: center;"}
   ![image](/images/user-guide/shared-attributes.svg)
   {: refdef}  

## API атрибутов устройства

Платформа предоставляет следующий API для приложений на устройстве:
 
 - загрузка *client-side* атрибутов на сервер.
 - запрос *client-side* и *shared* атрибутов с сервера.
 - подписка на обновление *shared* атрибутов.

API атрибутов специфичен для каждого поддерживаемого сетевого протокола. Ознакомиться с API и примерами вы можете в соответствующих разделах документации:

 - [описание MQTT API](/docs/reference/mqtt-api/#attributes-api)
 - [описание CoAP API](/docs/reference/coap-api/#attributes-api)
 - [описание HTTP API](/docs/reference/http-api/#attributes-api)
  
## Сервис телеметрии

Сервис телеметрии отвечает за сохранение данных атрибутов во внутреннем хранилище; предоставляет серверный API для запроса и подписки на обновления атрибутов. 

### Внутренняя база данных

Платформа использует Cassandra NoSQL или SQL БД для хранения всех данных

Кроме возможности запроса данных напрямую, платформа предоставляет набор RESTful и Websocket API, которые упрощают этот процесс с учетом политик безопасности:

 - тенант-администратор может управлять атрибутами для всех сущностей, принадлежащих соответствующему теннанту.
 - клиент может управлять атрибутами только для сущностей, назначенных соответствующему клиенту.
  
### API запроса данных

Сервис телеметрии предоставляет следующий REST API для получения данных с сущностей:

![image](/images/user-guide/telemetry-service/rest-api.png)

**Примечание:** API, приведенный выше, доступен через Swagger UI, пожалуйста, ознакомьтесь с общей документацией REST API для получения более подробной информации. 

#### API ключей атрибутов

Вы можете получить список всех ключей атрибутов для конкретного типа и идентификатора сущности с помощью GET-запроса по следующему URL: 
 
```shell
http(s)://host:port/api/plugins/telemetry/{entityType}/{entityId}/keys/attributes
```

{% capture tabspec %}get-attributes-keys
A,get-attributes-keys.sh,shell,resources/get-attributes-keys.sh,/docs/user-guide/resources/get-attributes-keys.sh
B,get-attributes-keys-result.json,json,resources/get-attributes-keys-result.json,/docs/user-guide/resources/get-attributes-keys-result.json{% endcapture %}
{% include tabs.html %}

Поддерживаемые типы сущностей: TENANT, CUSTOMER, USER, RULE, DASHBOARD, ASSET, DEVICE, ALARM

#### API значений атрибутов

Вы можете получить список последних значений для конкретного типа и идентификатора сущности с помощью GET-запроса по следующему URL:  
 
```shell
http(s)://host:port/api/plugins/telemetry/{entityType}/{entityId}/values/attributes?keys=key1,key2,key3
```

{% capture tabspec %}get-telemetry-values
A,get-attributes-values.sh,shell,resources/get-attributes-values.sh,/docs/user-guide/resources/get-attributes-values.sh
B,get-attributes-values-result.json,json,resources/get-attributes-values-result.json,/docs/user-guide/resources/get-attributes-values-result.json{% endcapture %}
{% include tabs.html %}

Поддерживаемые типы сущностей: TENANT, CUSTOMER, USER, RULE, DASHBOARD, ASSET, DEVICE, ALARM

### Телеметрия узлов правил

В движке правил есть узлы правил (Rule Nodes), которые позволяют работать с Сервисом Телеметрии. Более подробную информацию вы найдете в описании узла:

## Визуализация данных

Платформа предоставляет возможность настраивать и кастомизировать дашборды для визуализации данных. Эта тема рассматривается в отдельном руководстве.  
<p><a href="/docs/user-guide/visualization" class="button">Руководство по визуализации данных</a></p>

Платформа позволяет настраивать кастомные IoT-дашборды. Каждый IoT-дашборд может иметь несколько виджетов, которые визуализируют данные с нескольких устройств. После создания IoT-дашборда вы можете присвоить ее одному из клиентов вашего IoT-приложения
IoT-дашборды не требовательны к ресурсам, и их у вас может быть множество. Например, вы можете автоматически создавать дашборд для каждого нового клиента на основе данных с зарегистрированных IoT-устройств. Или вы можете изменить дашборд с помощью скрипта, когда новое устройство присваивается клиенту. Все эти действия могут быть выполнены вручную или автоматизированы с помощью REST API.


## Движок правил

Платформа предоставляет возможность настройки правил обработки данных. Атрибуты устройства можно использовать внутри фильтров правил. Это позволяет применять правила, основанные на определенных свойствах устройства. Более подробную информацию вы можете найти в отдельном руководстве.

<p><a href="/docs/user-guide/rule-engine" class="button">Описание движка правил.</a></p>
    
