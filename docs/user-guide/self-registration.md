---
layout: docwithnav
title: Самостоятельная регистрация
description: Самостоятельная регистрация

---

* TOC
{:toc}

Функция самостоятельной регистрации платформы позволяет тенанту настроить страницу регистрации для своих клиентов, чтобы они могли просто зарегистрироваться и войти в систему с предопределенными конфигурациями. 

## Описание вариантов использования

Как тенант-администратор, я хотел бы разрешить пользователям регистрировать свою собственную учетную запись на моем экземпляре IoT-платформы. Как только они зарегистрируются, я хотел бы позволить им видеть конкретные даборды и предоставлять свои собственные устройства или подтверждать существующие. Давайте начнем с предварительных действий.

### Шаг 1. Настройка почтового сервера

Войдите в свой экземпляр платформы в качестве тенант-администратора и перейдите в раздел Whitelabeling —> Mail server. Настройте платформу, используя настройки вашего SMTP-сервера. Если у вас его нет, проще всего использовать SendGrid. Дополнительные сведения см. в руководстве по настройкам почты.
Не забудьте проверить настройки почтового сервера с помощью кнопки “Отправить тестовое письмо”.

![image](/images/user-guide/self-registration/mailserver.png)

### Шаг 2. Создайте новые пользовательские роли

Создайте роль «клиент-администратор». Перейдите в раздел «роли» и нажмите кнопку “+”. Эта роль автоматически генерируется при создании первой сущности «Клиент» в области действий вашего клиента. Если у вас еще нет этой роли, вы можете легко добавить ее. Тип роли является “общим” и позволяет выполнять все операции для всех сущностей.

![image](/images/user-guide/self-registration/customer-admin-role.png)

Таким образом, когда вы применяете эту роль к своему пользователю-клиенту, он может контролировать каждую сущность в своей области действия. Конечно, вы можете создавать разные роли. Например, мы можем создать read-only роль.

Групповая read-only роль. Мы будем использовать эту роль, чтобы предоставить read-only доступ к конкретному дашборду. Этот дашборд будет одинаковым для всех наших самостоятельно зарегистрированных клиентов.

![image](/images/user-guide/self-registration/read-only-role.png)

### Шаг 3. Создайте общий дашборд

Сначала перейдите в раздел “Группы устройств” -> ”все” и создайте образец устройства с именем “устройство A” и типом “датчик”. Это необходимо для прохождения определенной проверки при импорте дашборда.
Теперь давайте перейдем к группам дашбордов и создадим новую под названием “Общий дашборд". Импортируйте простой дашборд, который показывает список устройств. Этот дашборд предоставляет возможность добавлять/редактировать/удалять устройства. Кстати, мы используем новый виджет из пакета Entity Admin Widgets Bundle.

Есть несколько вещей, на которые нужно обратить внимание.

![image](/images/user-guide/self-registration/dashboard.gif)

Давайте посмотрим, что происходит, когда мы хотим добавить устройство. Эта и другие формы пользовательского интерфейса настраиваются в кофигурациях виджета. Откройте режим редактирования, нажмите кнопку «Изменить виджет» и перейдите в раздел «Действия». Здесь вы можете увидеть три пользовательских действия. Удалить действие легко, но для их добавления и редактирования используется совершенно новая функция под названием “HTML шаблоны”. Теперь вы можете полностью контролировать пользовательский интерфейс и логику ваших диалогов. Давайте откроем действие “добавить” и развернем его на весь экран.

![image](/images/user-guide/self-registration/dashboard-config.png)
 
Вы можете увидеть пользовательские ресурсы, вкладки CSS, HTML и JS. Это именно то место, где настраиваются Add/Edit-диалоги. Подробнее о пользовательских действиях и формах смотрите в отдельном видео-руководстве.

![image](/images/user-guide/self-registration/action-config.png)

### Шаг 4. Заполните форму, чтобы открыть дашборд в полноэкранном режиме

Наконец, мы можем предоставить нашу регистрационную форму. Используйте свой домен и учетные данные ReCAPTCHA.
Добавьте две групповые пользовательские роли. Одну – для клиента-администратора. Важно, чтобы наш новый пользователь мог создавать и редактировать любые сущности внутри «Клиента». Вторая дает read-only доступ к общей панели мониторинга, которую мы только что создали. Мы делаем эту панель мониторинга панелью по умолчанию и отмечаем пункт “Всегда полный экран”
Измените текстовое сообщение и Политику конфиденциальности (опционально).

![image](/images/user-guide/self-registration/signup-form-config.png)

Поздравляем! Вы завершили настройку формы самостоятельной регистрации. Теперь сохраняйте её и перейдите к форме регистрации. Создайте нового пользователя и убедитесь, что он полностью изолирован и контролирует собственные устройства.

См. пример формы регистрации ниже:

![image](/images/user-guide/self-registration/signup-form.png)
